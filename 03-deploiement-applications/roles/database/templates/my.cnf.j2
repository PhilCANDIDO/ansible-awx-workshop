# Configuration MySQL personnalisée
# {{ ansible_managed }}

[mysqld]
# Configuration réseau
port = {{ mysql_port }}
bind-address = {{ mysql_bind_address }}
socket = {{ mysql_socket }}

# Répertoires
datadir = {{ mysql_datadir }}
pid-file = {{ mysql_pid_file }}

# Encodage par défaut
character-set-server = {{ mysql_charset }}
collation-server = {{ mysql_collation }}

# Configuration des ressources
max_connections = {{ mysql_max_connections }}
max_allowed_packet = {{ mysql_max_allowed_packet }}

# InnoDB
innodb_buffer_pool_size = {{ mysql_innodb_buffer_pool_size }}
innodb_log_file_size = {{ mysql_innodb_log_file_size }}
innodb_flush_log_at_trx_commit = 1
innodb_file_per_table = ON

# Cache de requêtes
query_cache_size = {{ mysql_query_cache_size }}
query_cache_limit = {{ mysql_query_cache_limit }}
query_cache_type = 1

# Logs
general_log = {{ mysql_general_log }}
general_log_file = {{ mysql_general_log_file }}
log_error = {{ mysql_error_log }}
slow_query_log = {{ mysql_slow_query_log }}
slow_query_log_file = {{ mysql_slow_query_log_file }}
long_query_time = {{ mysql_long_query_time }}

# Sécurité
sql_mode = STRICT_TRANS_TABLES,NO_ENGINE_SUBSTITUTION
skip-name-resolve

[mysql]
default-character-set = {{ mysql_charset }}

[client]
port = {{ mysql_port }}
socket = {{ mysql_socket }}
default-character-set = {{ mysql_charset }}